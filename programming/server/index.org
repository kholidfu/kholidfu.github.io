#+TITLE: server dan command line - labs127.io and me
#+AUTHOR: Kholid Fuadi
#+DATE: <2015-10-01 Thu>
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="../../stylesheet.css" />
#+STARTUP: indent


* <<sec:1>>Mencegah SSH Timeout
  Bagi Anda yang sering melakukan koneksi SSH ke server, tentu sangat
  mengganggu bukan? Solusinya mudah, tambahkan atau buat konfigurasi baru
  di berkas =~/.ssh/config=:

  #+BEGIN_SRC text
    Host *
      ServerAliveInterval 10
  #+END_SRC

* <<sec:2>>Membuat / Menambah swap di Ubuntu
  Terkadang karena keterbatasan /memory/, kita tidak dapat melakukan
  instalasi paket atau /library/ tertentu di server. Hal ini pernah penulis
  alami ketika akan memasang /library/ =pandas=. Daripada harus upgrade 
  droplet, saya coba membuat swap di server tersebut, dan setelah membuat
  swap sebesar 1GB, library tersebut berhasil terpasang dengan sukses.

  Berikut ini langkah-langkahnya:
  #+BEGIN_SRC sh
    # create new partition 1M * 1024 = 1GB
    dd if=/dev/zero of=/swapfile bs=1M count=1024
    # set as swap
    mkswap /swapfile
    # activate the swap once
    swapon /swapfile
    # add to /etc/fstab to auto load when reboot [optional]
    /swapfile swap swap defaults 0 0
  #+END_SRC
* <<sec:3>>Set Locale di Ubuntu Server
Ini hal wajib yang perlu dilakukan ketika setup server, karena jika
belum diset, biasanya ada beberapa masalah yang muncul, misal tidak
mau login ke mongo console atau psql (postgresql).

Cara untuk setting locale (ubuntu) adalah dengan menyunting berkas 
=/etc/default/locale= dan isikan baris config berikut:

#+BEGIN_SRC text
  LC_ALL="en_US.UTF-8"
  LANG="en_US.UTF-8"
  LANGUAGE="en_US.UTF-8"
#+END_SRC

Selanjutnya silakan re-login atau reboot, agar setting berlaku.
* <<sec:4>>Mengatur depth level command tree
Perintah berikut ini membatasi kedalaman /output/ perintah =tree=
menjadi maksimal 2 level saja.
#+BEGIN_SRC sh
tree -L 2 somedir/
#+END_SRC
* <<sec:5>>Lock Package Version di Linux Mint
Salah satu kelebihan menggunakan Linux adalah mudahnya melakukan
/update/ paket melalui /package manager/ yang biasanya sudah
disediakan secara /default/ oleh tiap-tiap distro. Namun ini juga
terkadang membawa masalah tersendiri, kenapa?

Misalnya nih, saya baru saja membeli VGA Card merk ATI. Karena
dukungan /driver/ yang tidak terlalu bagus (dibanding NVIDIA),
terkadang ketika ada perubahan versi /kernel/, maka /driver/ yang
sudah terpasang menjadi tidak berjalan secara sempurna.

Untuk itu, setelah konfigurasi mapan, saya berpikir untuk me-lock
versi dari kernel yang saya gunakan. Dan ternyata Linux menyediakan
fitur untuk itu.

Kalau Anda pengguna Ubuntu (atau Mint), Anda dapat melakukan langkah
berikut:

#+BEGIN_SRC text
Go to System -> Administration -> Synaptic Package Manager.

Highlight the package and choose menu Package -> Lock Version.
#+END_SRC

Jika sudah, maka paket tersebut akan ada simbol gembok dan berwarna
merah, seperti yang terlihat dalam tangkapan layar berikut:

#+ATTR_HTML: :title :alt :style width:85%;
[[file:img/synaptic.png]]

*Note:*

This may not applied to server which need to be as up-to-date as
possible.
* <<sec:6>>Setting git dan SSH key
Capek kan kalo harus ngetik /username/ /password/ setiap kali =push=
atau =pull=? Biar tidak ngetik terus, kita membuat SSH key
saja. Caranya sebagai berikut:

*Membuat SSH key*
#+BEGIN_SRC sh
ssh-keygen -t rsa -b 4096 -C "your_email@example.com"
#+END_SRC

Selanjutnya ikuti saja petunjuknya, kalau saya memilih menyimpan key
di =~/.ssh/id_rsa.pub=, /which is default/. Untuk /passphrase/,
silakan diisi sesuai keinginan (kosong pun tidak masalah, tapi
sebaiknya diisi).

*Menambahkan SSH key ke git* 

Untuk github, silakan menuju profile, kemudian Settings, klik SSH
keys, kemudian Add SSH key.

Title bebas mau dinamai apa saja, tapi sebaiknya berupa string yang
terkait dengan mesin kita, misal =bantengpc=, untuk memudahkan
identifikasi saja sih, bahwa ssh_key ini kepunyaan mesin =bantengpc=.

Salin isi dari =~/.ssh/id_rsa.pub= kemudian /paste/ ke input
"Key". Kemudian klik Add key.

*Testing*

Ketik perintah berikut:
#+BEGIN_SRC sh
ssh -T git@github.com
#+END_SRC

Untuk pertama kali, maka akan muncul pesan konfirmasi yang isinya
kurang lebih sebagai berikut:
#+BEGIN_SRC text
The authenticity of host 'github.com (207.97.227.239)' can't be established.
# RSA key fingerprint is 16:27:ac:a5:76:28:2d:36:63:1b:56:4d:eb:df:a6:48.
# Are you sure you want to continue connecting (yes/no)?
#+END_SRC

Jawab saja /yes/, kemudian jika berhasil akan muncul keterangan sebagai berikut:
#+BEGIN_SRC text
Hi kholidfu! You've successfully authenticated, but GitHub does not
# provide shell access.
#+END_SRC

Selanjutnya yang tidak kalah penting adalah memastikan bahwa url
remote, berbentuk seperti ini:
#+BEGIN_SRC text
[remote "origin"]
	url = git@github.com:kholidfu/kholidfu.github.io.git
#+END_SRC

Ini berarti kita bisa menggunakan ssh key untuk login dan push. Tetapi
jika format url masih seperti ini:

#+BEGIN_SRC text
[remote "origin"]
    url = https://github.com/kholidfu/kholidfu.github.io.git
#+END_SRC

Silakan disesuaikan, karena format di atas melakukan autentikasi
menggunakan format usermame/password.
* <<sec:7>>Custom domain di localhost
Seringnya Anda melihat menggunakan IP 127.0.0.1 atau localhost saja,
bagaimana membuatnya menjadi seolah-olah punya nama, seperti misalnya
=test.com= atau =banteng.app=?

Tambahkan atau sunting berkas =/etc/hosts=:
#+BEGIN_SRC text
127.0.0.1 localhost banteng.app test.com
#+END_SRC

Sekarang localhost dapat Anda akses juga menggunakan =test.com= atau
=banteng.app=.
* <<sec:8>>Melihat paket yang terpasang di Ubuntu/Mint
Misal saya ingin mencari apakah paket =emacs= sudah terpasang di mesin
belum, jalankan perintah berikut:
#+BEGIN_SRC sh
dpkg -l | grep emacs
#+END_SRC
Perintah =dpkg -l= berarti melihat semua daftar paket yang terpasang,
kemudian kita lakukan filter dengan menggunakan perintah =grep=.

Alternatif lainnya, kita juga bisa menggunakan perintah berikut:
#+BEGIN_SRC sh
apt-cache search emacs
#+END_SRC

Maka akan muncul semua paket yang /terkait/ dengan paket yang kita
inginkan, dalam hal ini =emacs=.
* <<sec:9>>Docker di Linux Mint 17.1
Berikut ini cara install docker di Mint 17.1
#+BEGIN_SRC sh
sudo apt-get install docker.io
sudo apt-get install apparmor lxc cgroup-lite
sudo usermod -aG docker ${USER}
sudo service docker start
#+END_SRC
